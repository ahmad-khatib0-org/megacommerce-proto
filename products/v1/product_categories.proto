syntax = "proto3";

package products.v1;

import "shared/v1/types.proto";
import "shared/v1/validation.proto";

option cc_enable_arenas = true;
option go_package = "github.com/ahmad-khatib0-org/megacommerce-proto/gen/go/products/v1;v1";
option java_outer_classname = "ProductCategoriesProto";
option java_package = "org.megacommerce.products.v1";

message Category {
  string id = 1;
  string name = 2;
  string image = 3;
  repeated CategoryTranslations translations = 4;
  repeated Subcategory subcategories = 5;
}

message CategoryTranslations {
  string name = 1;
  string language = 2;
  int32 version = 3;
  map<string, SubcategoryTranslations> subcategories = 4;
}

message SubcategoryTranslations {
  string name = 1;
  map<string, string> attributes = 2;
  map<string, shared.v1.StringMap> data = 3;
}

message Subcategory {
  string id = 1;
  string name = 2;
  int32 version = 3;
  string created_at = 4;
  map<string, SubcategoryAttribute> attributes = 5;
}

// Top-level attribute with a typed validation
message SubcategoryAttribute {
  // wither this attribute required or optional
  bool required = 1;
  // input, select, tags ...
  string type = 2;
  // reference id to the attributes table (E.g weight is common for many products types,
  // so instead rewriting it each time, we store it in another table)
  optional string reference = 3;
  // for select type (E.g. ['white', 'black', ...])
  repeated string string_array = 4;
  // for select type (E.g. multiple colors)
  optional bool is_multiple = 5;
  // validation rules of this attribute
  shared.v1.ValidationField validation = 6;
}

syntax = "proto3";

package orders.v1;

import "inventory/v1/reservation_get.proto";
import "shared/v1/error.proto";
import "shared/v1/pagination.proto";

option cc_enable_arenas = true;
option go_package = "github.com/ahmad-khatib0-org/megacommerce-proto/gen/go/orders/v1;v1";
option java_outer_classname = "OrdersListProto";
option java_package = "org.megacommerce.orders.v1";

message OrdersListRequest {
  shared.v1.PaginationRequest pagination = 1;
  repeated string status = 2;
}

message OrdersListResponse {
  oneof response {
    OrdersListResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message OrdersListResponseData {
  repeated OrderListItem orders = 1;
  shared.v1.PaginationResponse pagination = 2;
}

// OrderListItem for minimal listing
message OrderListItem {
  string id = 1;

  int64 shipping_cents = 2;
  int64 total_cents = 3;
  string currency_code = 4;

  // Inventory reservation status - since inventory service is separate,
  // we include reservation status in order so UI shows what's reserved.
  inventory.v1.InventoryReservationStatus inventory_reservation_status = 5;

  // order lifecycle
  string status = 6; // e.g., CREATED, CONFIRMED, SHIPPED, CANCELLED, REFUNDED
  uint64 created_at = 7;

  // order line items with details
  repeated OrderLineListItem items = 8;
}

message OrderLineListItem {
  string id = 1;
  string order_id = 2;
  string product_id = 3;
  string variant_id = 4;
  string title = 5;
  int32 quantity = 6;

  // Price fields in cents
  uint64 unit_price_cents = 9; // charged price per unit at order time
  optional uint64 list_price_cents = 10; // optional
  optional uint64 sale_price_cents = 11; // optional
  optional uint64 discount_cents = 12; // total discount applied to this line (all units)
  uint64 tax_cents = 13; // tax for this line (total)
  uint64 shipping_cents = 14; // shipping for this line (total)
  uint64 total_cents = 15; // (quantity * unit_price) - discount + tax + shipping_cents

  // array of applied offer/promotion ids
  repeated string applied_offer_ids = 16;
  string status = 17;

  optional uint64 estimated_delivery_date = 18; // Unix timestamp in milliseconds
  string product_image = 19;
}

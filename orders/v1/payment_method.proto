syntax = "proto3";

package orders.v1;

import "shared/v1/error.proto";

option cc_enable_arenas = true;
option go_package = "github.com/ahmad-khatib0-org/megacommerce-proto/gen/go/orders/v1;v1";
option java_outer_classname = "PaymentMethodProto";
option java_package = "org.megacommerce.orders.v1";

message PaymentMethod {
  string id = 1;
  string user_id = 2;
  string type = 3; // 'card', 'paypal', 'apple', 'google'
  string name = 4;
  optional string last_four = 5; // Last 4 digits for card
  optional string expiry_date = 6; // MM/YY format
  bool is_default = 7;
  uint64 created_at = 8;
}

message PaymentAddMethodRequest {
  string type = 1; // 'card', 'paypal', 'apple', 'google'
  string name = 2;
  optional string last_four = 3; // For card
  optional string expiry_date = 4; // MM/YY format
  string token = 5; // Encrypted/tokenized payment info
}

message PaymentAddMethodResponse {
  oneof response {
    PaymentMethod data = 1;
    shared.v1.AppError error = 2;
  }
}

message PaymentRemoveMethodRequest {
  string payment_method_id = 1;
}

message PaymentRemoveMethodResponse {
  oneof response {
    PaymentRemoveMethodData data = 1;
    shared.v1.AppError error = 2;
  }
}

message PaymentRemoveMethodData {
  bool success = 1;
}

message PaymentMakeDefaultRequest {
  string payment_method_id = 1;
}

message PaymentMakeDefaultResponse {
  oneof response {
    PaymentMethod data = 1;
    shared.v1.AppError error = 2;
  }
}

message PaymentsListRequest {}

message PaymentsListResponse {
  oneof response {
    PaymentsListData data = 1;
    shared.v1.AppError error = 2;
  }
}

message PaymentsListData {
  repeated PaymentMethod payment_methods = 1;
}
